syntax = "proto3";

package commonfate.authz.v1alpha1;

import "commonfate/entity/v1alpha1/entity.proto";


service PolicyService {
    // adds Cedar policies for a particular policy store
    rpc BatchPutPolicySet(BatchPutPolicySetRequest) returns (BatchPutPolicySetResponse) {}

    rpc ListPolicySets(ListPolicySetsRequest) returns (ListPolicySetsResponse) {}

    rpc GetPolicySet(GetPolicySetRequest) returns (GetPolicySetResponse) {}

    rpc DeletePolicySet(DeletePolicySetRequest) returns (DeletePolicySetResponse) {}
}


message Policy {
    // ID of the policy.
    string id = 1;

    // Cedar code for the policy set.
    string text = 2;
}

message PolicySet {
    // ID of the policy set.
    string id = 1;
    
    // The policies contained in the policy set.
    repeated Policy policies = 2;
}

message PolicySetInput {
    // ID of the policy.
    string id = 1;
    // Cedar code for the policy set.
    string text = 2;
}


message ListPolicySetsRequest {
    // The token for the next page.
    string page_token = 4;
}

message ListPolicySetsResponse {
    repeated PolicySet policy_sets = 1;
    string next_page_token = 2;
}

message BatchPutPolicySetRequest {
    repeated PolicySetInput policy_sets = 3;
}

message BatchPutPolicySetResponse {}

message DeletePolicySetRequest {
     string id = 1;
}

message DeletePolicySetResponse {
    string id = 1;
}


message GetPolicySetRequest {
    // The token for the next page.
    string id = 1;
}

message GetPolicySetResponse {
    PolicySet policy_set = 1;
}